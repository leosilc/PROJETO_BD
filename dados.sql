/* Dados basicos */

-- insercao necessaria para a consulta 2 (divisao relacional) e consulta 4
INSERT INTO TIPO_ORGAO (CODIGO) VALUES ('COR'); -- CORACAO
INSERT INTO TIPO_ORGAO (CODIGO) VALUES ('RIM'); -- RIM
INSERT INTO TIPO_ORGAO (CODIGO) VALUES ('FIG'); -- FIGADO

-- insercao necessaria para a consulta 1 - hospital com mais transplantes
INSERT INTO HOSPITAL (CNPJ, NOME, RUA, NUMERO, BAIRRO, CIDADE, TELEFONE) 
VALUES ('11111111000111', 'SANTA CASA', 'RUA A', 100, 'CENTRO', 'SAO CARLOS', '1633330000');

-- insercao necessaria para a consulta 1 - hospital com menos transplantes
INSERT INTO HOSPITAL (CNPJ, NOME, RUA, NUMERO, BAIRRO, CIDADE, TELEFONE) 
VALUES ('22222222000122', 'UNIMED', 'RUA B', 200, 'VILA', 'SAO CARLOS', '1633331111');

-- insercao necessaria para a consulta 1 - hospital sem transplantes (para testar left join)
INSERT INTO HOSPITAL (CNPJ, NOME, RUA, NUMERO, BAIRRO, CIDADE, TELEFONE) 
VALUES ('33333333000133', 'HOSPITAL UNIVERSITARIO', 'RUA C', 300, 'CAMPUS', 'SAO CARLOS', '1633332222');

-- insercao para preencher requisito de 2 tuplas por tabela
INSERT INTO VEICULO (PLACA, MODELO, MEIO_TRANSPORTE) VALUES ('ABC1234', 'RENAULT MASTER', 'AMBULANCIA');
INSERT INTO VEICULO (PLACA, MODELO, MEIO_TRANSPORTE) VALUES ('HEL9999', 'H145', 'HELICOPTERO');


/* Inserindo pessoas */

-- Profissionais de Saude (Consulta 2)
-- insercao necessaria para a consulta 2 - medico com todos transplantes de todos os tipos de orgaos cadastrados
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('10000000001', 'KALIL', '100', 'SP', TO_DATE('1960-01-01', 'YYYY-MM-DD'));
-- insercao necessaria para a consulta 2 - medico comum
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('10000000002', 'LUCIANA', '101', 'SP', TO_DATE('1980-01-01', 'YYYY-MM-DD'));
-- insercao necessaria para a consulta 2 - medico sem operacoes
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('10000000003', 'FLAVIO', '102', 'SP', TO_DATE('1975-01-01', 'YYYY-MM-DD'));

-- Doadores
-- insercao de doador vivo para gerar orgaos das consultas
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('20000000001', 'JOAO CARLOS', '200', 'SP', TO_DATE('1990-01-01', 'YYYY-MM-DD'));
-- insercao de doador falecido para tabela morto
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('20000000002', 'JOSE FREITAS', '201', 'SP', TO_DATE('1950-01-01', 'YYYY-MM-DD'));

-- Receptores (Consulta 3 e 5)
-- insercao necessaria para a consulta 3 - paciente critico (espera longa)
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('30000000001', 'ALICE ALMEIDA', '300', 'SP', TO_DATE('1985-01-01', 'YYYY-MM-DD'));
-- insercao necessaria para a consulta 3 - paciente medio
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('30000000002', 'BRUNO CALABRIA', '301', 'SP', TO_DATE('1985-01-01', 'YYYY-MM-DD'));
-- insercao necessaria para a consulta 3 - paciente novo
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('30000000003', 'CARLOS KATSUMATA', '302', 'SP', TO_DATE('1985-01-01', 'YYYY-MM-DD'));
-- insercao necessaria para a consulta 5 - paciente aguardando match
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('30000000004', 'DANIELA BORGES', '303', 'SP', TO_DATE('1990-01-01', 'YYYY-MM-DD'));

-- Condutores
-- insercao para popular tabela condutor
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('40000000001', 'PEDRO ALMEIDA', '400', 'SP', TO_DATE('1970-01-01', 'YYYY-MM-DD'));
INSERT INTO PESSOA (CPF, NOME, RG, UF, DATA_NASCIMENTO) VALUES ('40000000002', 'PAULO JUNQUEIRA', '401', 'SP', TO_DATE('1975-01-01', 'YYYY-MM-DD'));


-- Equipe Medica
INSERT INTO EQUIPE_MEDICA (ID_PESSOA, DOCUMENTO_PROFISSIONAL_SAUDE, CARGO)
SELECT ID, '123', 'MEDICO' FROM PESSOA WHERE CPF = '10000000001'; -- KALIL
INSERT INTO EQUIPE_MEDICA (ID_PESSOA, DOCUMENTO_PROFISSIONAL_SAUDE, CARGO)
SELECT ID, '456', 'MEDICO' FROM PESSOA WHERE CPF = '10000000002'; -- LUCIANA
INSERT INTO EQUIPE_MEDICA (ID_PESSOA, DOCUMENTO_PROFISSIONAL_SAUDE, CARGO)
SELECT ID, '789', 'MEDICO' FROM PESSOA WHERE CPF = '10000000003'; -- FLAVIO

-- Pacientes (Todos os receptores e doadores devem ser pacientes primeiro)
INSERT INTO PACIENTE (ID_PESSOA, TIPO_SANGUINEO, FATOR_RH, ALTURA, PESO)
SELECT ID, 'O', '+', 1.70, 70 FROM PESSOA WHERE CPF LIKE '200%' OR CPF LIKE '300%';

-- Doadores
INSERT INTO DOADOR (ID_PACIENTE, ESTADO_SAUDE)
SELECT ID, 'SAUDAVEL' FROM PESSOA WHERE CPF = '20000000001'; -- JOAO
INSERT INTO DOADOR (ID_PACIENTE, ESTADO_SAUDE)
SELECT ID, 'OBITO' FROM PESSOA WHERE CPF = '20000000002'; -- JOSE

-- Tabela Morto
INSERT INTO MORTO (ID_DOADOR, DATA_HORA, CAUSA)
SELECT ID, SYSDATE-10, 'AVC' FROM PESSOA WHERE CPF = '20000000002'; -- hÃ¡ 10 dias

-- Receptores
INSERT INTO RECEPTOR (ID_PACIENTE)
SELECT ID FROM PESSOA WHERE CPF LIKE '300%';

-- Condutores
INSERT INTO CONDUTOR (ID_PESSOA, DOCUMENTO_HABILITACAO)
SELECT ID, 111 FROM PESSOA WHERE CPF = '40000000001';
INSERT INTO CONDUTOR (ID_PESSOA, DOCUMENTO_HABILITACAO)
SELECT ID, 222 FROM PESSOA WHERE CPF = '40000000002';

-- Tabelas extras para cumprir requisito de 2 linhas
INSERT INTO COMORBIDADES (ID_PACIENTE, COMORBIDADE) SELECT ID, 'DIABETES' FROM PESSOA WHERE CPF='30000000001';
INSERT INTO COMORBIDADES (ID_PACIENTE, COMORBIDADE) SELECT ID, 'HIPERTENSAO' FROM PESSOA WHERE CPF='30000000002';

/* Consultas */

-- Consulta 1: Alice consulta com Dr. Kalil
INSERT INTO CONSULTA (ID_PACIENTE, ID_MEDICO, DATA_HORA)
VALUES (
    (SELECT ID FROM PESSOA WHERE CPF='30000000001'), -- Alice
    (SELECT ID FROM PESSOA WHERE CPF='10000000001'), -- Kalil
    SYSDATE-15 
);

-- Consulta 2: Bruno consulta com Dr. Kalil
INSERT INTO CONSULTA (ID_PACIENTE, ID_MEDICO, DATA_HORA)
VALUES (
    (SELECT ID FROM PESSOA WHERE CPF='30000000002'), -- Bruno
    (SELECT ID FROM PESSOA WHERE CPF='10000000001'), -- Kalil
    SYSDATE-10 
);


/* Viagens e trechos */

-- insercao para popular tabela viagem
INSERT INTO VIAGEM (DATA_HORA_INICIO, HOSPITAL_ORIGEM, HOSPITAL_DESTINO)
VALUES (TO_DATE('2025-11-20 08:00', 'YYYY-MM-DD HH24:MI'), '22222222000122', '11111111000111'); -- ID gerado ex: 1

INSERT INTO VIAGEM (DATA_HORA_INICIO, HOSPITAL_ORIGEM, HOSPITAL_DESTINO)
VALUES (TO_DATE('2025-11-21 10:00', 'YYYY-MM-DD HH24:MI'), '22222222000122', '11111111000111'); -- ID gerado ex: 2

-- insercao para popular tabela trecho e realiza
INSERT INTO TRECHO (ID_VIAGEM, DATA_HORA_PARTIDA, VEICULO)
SELECT MIN(ID), TO_DATE('2025-11-20 08:05', 'YYYY-MM-DD HH24:MI'), 'ABC1234' FROM VIAGEM;

INSERT INTO TRECHO (ID_VIAGEM, DATA_HORA_PARTIDA, VEICULO)
SELECT MAX(ID), TO_DATE('2025-11-21 10:05', 'YYYY-MM-DD HH24:MI'), 'HEL9999' FROM VIAGEM;

INSERT INTO REALIZA (ID_CONDUTOR, ID_TRECHO_VIAGEM, DATA_HORA_PARTIDA_TRECHO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='40000000001'), (SELECT MIN(ID) FROM VIAGEM), TO_DATE('2025-11-20 08:05', 'YYYY-MM-DD HH24:MI'));

INSERT INTO REALIZA (ID_CONDUTOR, ID_TRECHO_VIAGEM, DATA_HORA_PARTIDA_TRECHO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='40000000002'), (SELECT MAX(ID) FROM VIAGEM), TO_DATE('2025-11-21 10:05', 'YYYY-MM-DD HH24:MI'));


/* Orgaos e transplantes */

-- Orgaos do Joao (Para o Dr. Kalil operar TODOS e validar Consulta 2)
-- insercao necessaria para a consulta 2 (orgao RIM)
INSERT INTO ORGAO_ESPECIFICO (ID_DOADOR, TIPO_ORGAO, DATA_HORA, LATERALIDADE, STATUS, ID_VIAGEM)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='20000000001'), 'RIM', SYSDATE-5, 'D', 'FUNCIONAL', (SELECT MIN(ID) FROM VIAGEM));

-- insercao necessaria para a consulta 2 (orgao CORACAO)
INSERT INTO ORGAO_ESPECIFICO (ID_DOADOR, TIPO_ORGAO, DATA_HORA, LATERALIDADE, STATUS)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='20000000001'), 'COR', SYSDATE-5, NULL, 'FUNCIONAL');

-- insercao necessaria para a consulta 2 (orgao FIGADO)
INSERT INTO ORGAO_ESPECIFICO (ID_DOADOR, TIPO_ORGAO, DATA_HORA, LATERALIDADE, STATUS)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='20000000001'), 'FIG', SYSDATE-5, NULL, 'FUNCIONAL');

-- Orgao extra para Consulta 4 e 5 (Disponivel/Nao transplantado)
-- insercao necessaria para consulta 4 e 5 - orgao livre
INSERT INTO ORGAO_ESPECIFICO (ID_DOADOR, TIPO_ORGAO, DATA_HORA, LATERALIDADE, STATUS)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='20000000002'), 'COR', SYSDATE, NULL, 'DISPONIVEL');


/* Realizando transplantes */

-- Transplante 1 (Rim -> Alice)
INSERT INTO TRANSPLANTE (ID_ORGAO, ID_RECEPTOR, DATA_HORA_IMPLANTE, STATUS, HOSPITAL)
VALUES ((SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='RIM'), (SELECT ID FROM PESSOA WHERE CPF='30000000001'), SYSDATE-4, 'SUCESSO', '11111111000111');

-- Transplante 2 (Coracao -> Bruno)
INSERT INTO TRANSPLANTE (ID_ORGAO, ID_RECEPTOR, DATA_HORA_IMPLANTE, STATUS, HOSPITAL)
VALUES ((SELECT MIN(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='COR'), (SELECT ID FROM PESSOA WHERE CPF='30000000002'), SYSDATE-4, 'SUCESSO', '11111111000111');

-- Transplante 3 (Figado -> Carlos)
INSERT INTO TRANSPLANTE (ID_ORGAO, ID_RECEPTOR, DATA_HORA_IMPLANTE, STATUS, HOSPITAL)
VALUES ((SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='FIG'), (SELECT ID FROM PESSOA WHERE CPF='30000000003'), SYSDATE-4, 'SUCESSO', '22222222000122');


/* Responsaveis (VALIDANDO A DIVISAO RELACIONAL) */

-- Dr. Kalil participa de TODOS os tipos
INSERT INTO RESPONSAVEL (ID_PROFISSIONAL_SAUDE, ORGAO_TRANSPLANTE) VALUES ((SELECT ID FROM PESSOA WHERE CPF='10000000001'), (SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='RIM'));
INSERT INTO RESPONSAVEL (ID_PROFISSIONAL_SAUDE, ORGAO_TRANSPLANTE) VALUES ((SELECT ID FROM PESSOA WHERE CPF='10000000001'), (SELECT MIN(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='COR')); -- O coracao transplantado
INSERT INTO RESPONSAVEL (ID_PROFISSIONAL_SAUDE, ORGAO_TRANSPLANTE) VALUES ((SELECT ID FROM PESSOA WHERE CPF='10000000001'), (SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='FIG'));

-- Dra. Luciana participa so de um (Nao deve aparecer na consulta 2)
INSERT INTO RESPONSAVEL (ID_PROFISSIONAL_SAUDE, ORGAO_TRANSPLANTE) VALUES ((SELECT ID FROM PESSOA WHERE CPF='10000000002'), (SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='RIM'));

-- Inserindo Complicacoes (2 linhas)
INSERT INTO COMPLICACOES (ID_ORGAO, COMPLICACAO) VALUES ((SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='RIM'), 'REJEICAO LEVE');
INSERT INTO COMPLICACOES (ID_ORGAO, COMPLICACAO) VALUES ((SELECT MAX(ID) FROM ORGAO_ESPECIFICO WHERE TIPO_ORGAO='FIG'), 'INFECCAO');


/* Lista de espera */

-- insercao necessaria para a consulta 3 - Alice espera ha 300 dias (Acima da media de 136)
INSERT INTO LISTA_ESPERA (ID_RECEPTOR, TIPO_ORGAO, DATA_HORA_ENTRADA, POSICAO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='30000000001'), 'RIM', SYSDATE-300, 1);

-- insercao necessaria para a consulta 3 - Bruno espera ha 100 dias
INSERT INTO LISTA_ESPERA (ID_RECEPTOR, TIPO_ORGAO, DATA_HORA_ENTRADA, POSICAO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='30000000002'), 'RIM', SYSDATE-100, 2);

-- insercao necessaria para a consulta 3 - Carlos espera ha 10 dias
INSERT INTO LISTA_ESPERA (ID_RECEPTOR, TIPO_ORGAO, DATA_HORA_ENTRADA, POSICAO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='30000000003'), 'RIM', SYSDATE-10, 3);

-- insercao necessaria para a consulta 5 - Daniela quer CORACAO (Existe um livre inserido)
INSERT INTO LISTA_ESPERA (ID_RECEPTOR, TIPO_ORGAO, DATA_HORA_ENTRADA, POSICAO)
VALUES ((SELECT ID FROM PESSOA WHERE CPF='30000000004'), 'COR', SYSDATE-50, 1);

COMMIT;